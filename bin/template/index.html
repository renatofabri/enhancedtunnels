<!DOCTYPE html>
<html lang='en'>
    <head>
        <title>Tunneller</title>
        <link href="css/reset.css" rel="stylesheet">
        <link href="css/bootstrap.css" rel="stylesheet">
        <link href="custom/style.css" rel="stylesheet">
    </head>
    <body>
        <div class="container-fluid">

            <!-- main container -->
            <div id="app-window-main" class="row app-window">
                <!-- main row - covers complete screen -->
                
                <div class="col-sm-1 app-sidebar">
                    <!-- sidebar -->
                    <div class="container-fluid">
                        <ul class="app-sidebar-menu">
	                        <li class="app-button app-active-button">
	                        	<a href="#">
	                        		<span class="glyphicon glyphicon-hdd"></span>
	                        		<span>Server</span>
	                        	</a>
	                        </li>
	                        <li class="app-button app-last-button">
	                        	<a href="#">
	                        		<span class="glyphicon glyphicon-info-sign"></span>
	                        		<span>About</span>
	                        	</a>
	                        </li>
                        </ul>
                    </div>
                </div>

                <div class="col-sm-11 app-main">
                    <!-- main application view -->
                    <div class="container-fluid app-server-view">
                        <div class="row">
                            <h2>
                                Click in a server to view details,
                                <button id="startAllServers" class="btn btn-primary" onclick="toggleServerForm()">Add Server
                                </button>
                                or 
                                <button id="startAllServers" class="btn btn-primary disabled" onclick="callJavaFX('launch all')">Launch All Servers
                                    <span class="glyphicon glyphicon-play"></span>
                                </button>
                            </h2>
                        </div>
                        <!-- server operation div -->
                   		<div id="app-server-operation" class="row" style="display: none;">
							<h3>Create Server</h3>
							<form id="serverForm">
								<div class="row">
									<div class="form-group col-md-5">
										<label for="serverName">Display name</label>
										<input type="text" class="form-control" id="serverName" placeholder="" required/>
									</div>
									<div class="form-group col-md-5">
										<label for="serverHost">Host</label>
										<input type="text" class="form-control" id="serverHost" placeholder="" required/>
									</div>
									<div class="form-group col-md-2">
										<label for="serverPort">Port</label>
										<input type="text" class="form-control" id="serverPort" placeholder=""/>
									</div>
								</div>
								<div class="row">
									<div class="form-group col-md-4">
										<label for="serverUsername">Username</label>
										<input type="text" class="form-control" id="serverUsername" placeholder="" required/>
									</div>
									<div class="form-group col-md-4">
										<label for="serverPassword">Password</label>
										<input type="text" class="form-control" id="serverPassword" placeholder="" required/>
									</div>
									<div class="col-md-4">
										<div style="margin-top: 25px">
											<button onclick="toggleServerForm()" class="btn btn-default pull-right">Cancel</button>
											<button onclick="saveServerForm()" class="btn btn-primary pull-right" style="margin-right: 10px;">Create</button>
										</div>
									</div>
								</div>
							</form>
						</div>
                        <!-- tunnel operation div -->
                   		<div id="app-tunnel-operation" class="row" style="display: none;">
							<h3>Create Tunnel</h3>
							<form id="tunnelForm">
								<div class="row">
									<div class="form-group col-md-5">
										<label for="tunnelName">Tunnel display name</label>
										<input type="text" class="form-control" id="tunnelName" placeholder="" required/>
										<input type="hidden" id="tunnelServerId" placeholder="" required/>
									</div>
								</div>
								<div class="row">
									<div class="form-group col-md-2">
										<label for="tunnelLocalPort">Local port</label>
										<input type="text" class="form-control" id="tunnelLocalPort" placeholder=""/>
									</div>
									<div class="form-group col-md-5">
										<label for="tunnelRemoteHost"> Remote host</label>
										<input type="text" class="form-control" id="tunnelRemoteHost" placeholder="" required/>
									</div>
									<div class="form-group col-md-2">
										<label for="tunnelRemotePort">Remote port</label>
										<input type="text" class="form-control" id="tunnelRemotePort" placeholder=""/>
									</div>
								</div>
								<div class="row">
									<div class="form-group col-md-4">
										<label for="tunnelDescription">Short description</label>
										<input type="text" class="form-control" id="tunnelDescription" placeholder="" required/>
									</div>
									<div class="col-md-5">
										<div style="margin-top: 25px">
											<button onclick="toggleTunnelForm()" class="btn btn-default pull-right">Cancel</button>
											<button onclick="saveTunnelForm()" class="btn btn-primary pull-right" style="margin-right: 10px;">Create</button>
										</div>
									</div>
								</div>
							</form>
						</div>
						<!-- server table div -->
                        <div id="app-main-view" class="row app-server-table">
                            <table class="">
                                <tbody id="app-server-list">
                                    
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <script src="js/jquery-3.2.1.min.js" type="application/javascript"></script>
        <script src="custom/events.js" type="application/javascript"></script>
        <script src="custom/script.js" type="application/javascript"></script>
        <script type="application/javascript">
	        function resize()
	        {
	            var heights = window.innerHeight;
	            document.getElementById("app-window-main").style.height = heights + "px";
	        }
	        resize();
	        window.onresize = function() {
	            resize();
	        };

        	function callJavaFX(text) {
        		app.callFromJavascript(text);
        	}

        	function saveServerForm() {

        		const obj = new Object();
        	    obj.serverName = document.forms["serverForm"]["serverName"].value;
        	    obj.serverHost = document.forms["serverForm"]["serverHost"].value;
        	    obj.serverPort = document.forms["serverForm"]["serverPort"].value;
        	    if (isNaN(obj.serverPort)) {
        	    	return false;
        	    }
        	    obj.serverUsername = document.forms["serverForm"]["serverUsername"].value;
        	    obj.serverPassword = document.forms["serverForm"]["serverPassword"].value;

        	    app.saveServer(obj);
        		
        		location.reload();
        	}
        	
        	function saveTunnelForm() {

        		const obj = new Object();
        		
        		obj.tunnelName = document.forms["tunnelForm"]["tunnelName"].value;
        		obj.tunnelLocalPort = document.forms["tunnelForm"]["tunnelLocalPort"].value;
        	    if (isNaN(obj.tunnelLocalPort)) {
        	    	return false;
        	    }
        		obj.tunnelRemoteHost = document.forms["tunnelForm"]["tunnelRemoteHost"].value;
        		obj.tunnelRemotePort = document.forms["tunnelForm"]["tunnelRemotePort"].value;
        	    if (isNaN(obj.tunnelRemotePort)) {
        	    	return false;
        	    }
        		obj.tunnelDescription = document.forms["tunnelForm"]["tunnelDescription"].value;
        		obj.tunnelParentServer = document.forms["tunnelForm"]["tunnelServerId"].value;
        	    if (isNaN(obj.tunnelParentServer)) {
        	    	return false;
        	    }

        	    app.saveTunnel(obj);

        	    location.reload();
        	}

        	function deleteServerAction(id) {
        		app.deleteServer(id);
        		location.reload();
        	}
        	
       		function deleteTunnelAction(id) {
       			app.deleteTunnel(id);
       			location.reload();
       		}

        	function launchServerAction(id) {
        		app.launchServer(id);
        	}
        </script>
    </body>
</html>